var _baseComponent = require("../baseComponent");
var _parcelHelpers = require("@parcel/transformer-js/lib/esmodule-helpers.js");
var _baseComponentDefault = _parcelHelpers.interopDefault(_baseComponent);
require("./ispisOglasa");
var _modelAndControler = require("../modelAndControler");
var _modelAndControlerDefault = _parcelHelpers.interopDefault(_modelAndControler);
var _mojOglas = require("./mojOglas");
var _mojOglasDefault = _parcelHelpers.interopDefault(_mojOglas);
let controler = new _modelAndControlerDefault.default();
class MojiOglasi extends _baseComponentDefault.default {
  constructor() {
    super("div");
    controler.addEventListener("dodanJeOglas", event => {
      this.dodanOglas(event.detail.oglas);
    });
    let sadrzaj = document.createElement("div");
    let user = JSON.parse(localStorage["user"]);
    if (user == false) {
      sadrzaj.innerHTML = "";
    } else {
      let database = firebase.firestore();
      database.collection("korisnici").where("username", "==", user.username).get().then(function (querySnapshot) {
        querySnapshot.forEach(doc => {
          let korisnik = doc.data();
          korisnik.oglasi.forEach(el => {
            let oglas = new _mojOglasDefault.default(el.id, korisnik.kontakt, el.opis, el.lokacija, el.cijena, el.razina, el.ocjena.like, el.ocjena.dislike, korisnik.username);
            sadrzaj.appendChild(oglas.rootElement);
          });
        });
      });
    }
    let button = document.createElement("a");
    button.className = "btn modal-trigger col s12 waves-effect waves-light btn";
    button.href = "#modal1";
    button.innerHTML = "Dodaj oglas";
    document.getElementById("dodajOglas").addEventListener("click", () => {
      this.dodajOglas();
    });
    /**/
    this.addChildren([button, sadrzaj]);
  }
  dodanOglas() {}
}
module.exports = MojiOglasi;
